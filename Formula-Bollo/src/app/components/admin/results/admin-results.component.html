<div class="modifyResults pt-5 px-5">
  <div class="modifyResults-topSide d-flex justify-content-evenly flex-wrap mb-5">
    <form [formGroup]="circuitsForm">
      <div class="modifyResults-topSide d-flex flex-column">
        <label class="mb-1">Seleccione circuito:</label>
        <mat-form-field>
          <mat-select formControlName="circuit">
            <mat-option *ngFor="let circuit of circuits" [value]="circuit">
              {{ circuit.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </form>

    <form [formGroup]="raceForm" *ngIf="circuitSelected">
      <div class="modifyResults-topSide d-flex flex-column">
        <label class="mb-1">Seleccione Fecha Inicio:</label>
        <p-calendar [(ngModel)]="raceDate" [showTime]="true" [showSeconds]="true" formControlName="raceDate" placeholder="Fecha Inicio"></p-calendar>
      </div>
    </form>

    <form [formGroup]="fastLapForm" *ngIf="circuitSelected">
      <div class="modifyResults-topSide d-flex flex-column">
        <label class="mb-1">Seleccione Vuelta Rápida:</label>
        <mat-form-field *ngIf="results.length > 0">
          <mat-select formControlName="fastlap" [(value)]="fastLapSelected">
            <mat-option *ngFor="let result of results" [value]="result">
              {{ result.driver.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="results.length == 0">
          <mat-select formControlName="fastlap" [(value)]="fastLapSelected">
            <mat-option *ngFor="let driver of drivers" [value]="driver">
              {{ driver.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </form>
  </div>

  <h5 class="modifyResults-bottomSide-title w-100 text-center mt-4 mb-5" *ngIf="circuitSelected">Resultados</h5>
  <form [formGroup]="resultsForm" *ngIf="circuitSelected && results.length > 0" class="resultsForm m-auto">
    <div class="modifyResults-bottomSide row">
      <div class="modifyResults-bottomSide-resultsGood col-12 col-md-6 d-flex flex-column align-items-center" *ngFor="let result of results; let i = index">
        <p *ngIf="result.position">Posición {{ i + 1 }}</p>
        <mat-form-field *ngIf="result.position">
          <mat-select [formControlName]="'result' + i">
            <mat-option *ngFor="let result of results" [value]="result">
              {{ result.driver.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <h5 class="modifyResults-bottomSide-title w-100 text-center mt-4 mb-5">Pilotos descalificados</h5>
      <div class="modifyResults-bottomSide-resultsBad col-12 col-md-6 d-flex flex-column align-items-center" *ngFor="let result of results.slice(findFirstDisqualifiedIndex()); let i = index">
        <mat-form-field *ngIf="result && i < (results.length - findFirstDisqualifiedIndex() - 1)">
          <mat-select [formControlName]="'result' + (i + findFirstDisqualifiedIndex())">
            <mat-option *ngFor="let disqualifiedResult of results" [value]="disqualifiedResult">
              {{ disqualifiedResult.driver.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </form>

  <form [formGroup]="resultsForm" *ngIf="circuitSelected && results.length == 0" class="resultsForm m-auto">
    <div class="modifyResults-bottomSide row">
      <div class="modifyResults-bottomSide-resultsGood col-6 d-flex flex-column align-items-center" *ngFor="let driver of drivers.slice(1); let i = index">
        <p>Posición {{ i + 1 }}</p>
        <mat-form-field>
          <mat-select [formControlName]="'result' + i">
            <mat-option *ngFor="let driver of drivers" [value]="driver">
              {{ driver.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </form>

  <div class="d-flex align-items-center">
    <button mat-button class="mx-auto my-5 modifyResults-button p-2 shadow" *ngIf="saveButtonActivated" (click)="saveAllForms()">Guardar</button>
  </div>
</div>
